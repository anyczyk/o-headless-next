(()=>{"use strict";const e=window.wp.htmlEntities,t=window.wc.wcSettings,a=window.wc.blocksComponents,r=window.wc.wcBlocksRegistry,s=window.wp.i18n,o=window.wp.element,n=window.ReactJSXRuntime,i=({errors:e})=>(0,n.jsx)("div",{className:"payu-sf-validation-error",children:e&&Array.isArray(e)&&e.map(e=>e.message).concat(" ")}),c=({secureForms:e,formOptions:t,errors:a,setElementFocus:r})=>((0,o.useEffect)(()=>{const a=e.add("number",t);a.render("#payu-card-number"),a.on("change",({empty:e,error:t,length:a})=>{!1===e&&!1===t&&16===a&&r("expire")})},[]),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{className:"payu-card-form",id:"payu-card-number"}),(0,n.jsx)(i,{errors:a})]})),d=({secureForms:e,formOptions:t,errors:a,setElementFocus:r,focus:s})=>{const[c]=(0,o.useState)(()=>e.add("date",t));return(0,o.useEffect)(()=>{!0===s&&c.focus()},[s,c]),(0,o.useEffect)(()=>{c.render("#payu-card-date"),c.on("change",({empty:e,error:t})=>{!1===e&&!1===t&&r("cvv")})},[]),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{className:"payu-card-form",id:"payu-card-date"}),(0,n.jsx)(i,{errors:a})]})},p=({secureForms:e,formOptions:t,errors:a,focus:r})=>{const[s]=(0,o.useState)(()=>e.add("cvv",t));return(0,o.useEffect)(()=>{!0===r&&s.focus()},[r,s]),(0,o.useEffect)(()=>{s.render("#payu-card-cvv")},[]),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{className:"payu-card-form",id:"payu-card-cvv"}),(0,n.jsx)(i,{errors:a})]})},l={cardIcon:!0,style:{basic:{fontSize:"18px"}},placeholder:{number:"",date:"",cvv:""}},y=({children:e,onCLick:t})=>(0,n.jsx)("span",{className:"payu-read-more",onClick:t,onKeyDown:t,role:"button",tabIndex:0,children:e}),u="payusecureform",m=(0,t.getSetting)(`${u}_data`,{}),h=(0,e.decodeEntities)(m.available||!1),w=(0,e.decodeEntities)(m.title||"PayU"),g=(0,e.decodeEntities)(m.description||""),f=m.icon,v=(0,e.decodeEntities)(m.additionalData?.posId)||"",x=(0,e.decodeEntities)(m.additionalData?.sdkUrl)||"",b=(0,e.decodeEntities)(m.additionalData?.lang)||"en",j=m.termsLinks;let _,E;const S=()=>{const[t,a]=(0,o.useState)(!1),[r,i]=(0,o.useState)(!1),c=(0,e.decodeEntities)(j.condition),d=(0,e.decodeEntities)(j.privacy);return(0,n.jsx)("div",{className:"payu-accept-conditions",children:(0,n.jsxs)("div",{className:"payu-conditions-description",children:[(0,n.jsxs)("div",{children:[(0,s.__)("Payment is processed by PayU SA; The recipient's data, the payment title and the amount are provided to PayU SA by the recipient;","woo-payu-payment-gateway")," ",!t&&(0,n.jsx)(y,{onCLick:()=>a(!0),children:(0,s.__)("read more","woo-payu-payment-gateway")}),t&&(0,n.jsx)(n.Fragment,{children:(0,s.__)("The order is sent for processing when PayU SA receives your payment. The payment is transferred to the recipient within 1 hour, not later than until the end of the next business day; PayU SA does not charge any service fees.","woo-payu-payment-gateway")})]}),(0,n.jsxs)("div",{children:[(0,s.__)("By paying you accept","woo-payu-payment-gateway")," ",(0,n.jsx)("a",{href:c,target:"_blank",rel:"noreferrer",children:(0,s.__)('"PayU Payment Terms"',"woo-payu-payment-gateway")}),"."]}),(0,n.jsxs)("div",{children:[(0,s.__)('The controller of your personal data is PayU S.A. with its registered office in Poznan (60–166), at Grunwaldzka Street 186 ("PayU").',"woo-payu-payment-gateway")," ",!r&&(0,n.jsx)(y,{onCLick:()=>i(!0),children:(0,s.__)("read more","woo-payu-payment-gateway")}),r&&(0,n.jsxs)(n.Fragment,{children:[(0,s.__)("Your personal data will be processed for purposes of processing payment transaction, notifying You about the status of this payment, dealing with complaints and also in order to fulfill the legal obligations imposed on PayU.","woo-payu-payment-gateway"),(0,n.jsx)("br",{}),(0,s.__)("The recipients of your personal data may be entities cooperating with PayU during processing the payment. Depending on the payment method you choose, these may include: banks, payment institutions, loan institutions, payment card organizations, payment schemes), as well as suppliers supporting PayU’s activity providing: IT infrastructure, payment risk analysis tools and also entities that are authorised to receive it under the applicable provisions of law, including relevant judicial authorities. Your personal data may be shared with merchants to inform them about the status of the payment.","woo-payu-payment-gateway"),(0,n.jsx)("br",{}),(0,s.__)("You have the right to access, rectify, restrict or oppose the processing of data, not to be subject to automated decision making, including profiling, or to transfer and erase Your personal data. Providing personal data is voluntary however necessary for the processing the payment and failure to provide the data may result in the rejection of the payment. For more information on how PayU processes your personal data, please click","woo-payu-payment-gateway")," ",(0,n.jsx)("a",{href:d,target:"_blank",rel:"noreferrer",children:(0,s.__)("PayU privacy policy","woo-payu-payment-gateway")}),"."]})]})]})})},k=({eventRegistration:e,emitResponse:t})=>{const{onPaymentSetup:r}=e,[i,y]=(0,o.useState)(),[m,h]=(0,o.useState)(),[w,f]=(0,o.useState)([]),[j,k]=(0,o.useState)("");return(0,o.useEffect)(()=>{const e=()=>{_=PayU(v),E=_.secureForms({lang:b})};return window.PayU?e():(e=>{let t=null;const a=()=>{t?.parentNode?.removeChild(t)};return{load:()=>new Promise((r,s)=>{const o=document.querySelector("body");o?(t=o.querySelector(`script[src="${e}"]`),t?.getAttribute("data-loaded")?r():(t=document.createElement("script"),t.src=e,t.async=!0,t.addEventListener("load",()=>{t?.setAttribute("data-loaded","true"),r()}),t.addEventListener("error",()=>{a(),s(new Error(`Unable to load script [${e}]`))}),o.appendChild(t))):s(new Error("Missing <body>"))}),remove:a}})(x).load().then(()=>{e()}).catch(e=>{console.error(e),y((0,s.__)("Choose other payment method.","woo-payu-payment-gateway"))}),()=>{_=void 0,E=void 0}},[]),(0,o.useEffect)(()=>(y(void 0),h(void 0),f([]),r(()=>{if(!E)return y((0,s.__)("Choose other payment method.","woo-payu-payment-gateway")),document.getElementById(`payu_description_${u}`).scrollIntoView({behavior:"smooth"}),{type:t.responseTypes.ERROR};try{return _.tokenize().then(e=>{if("SUCCESS"!==e.status){const a=e.error.messages.filter(e=>"technical"===e.type);return a.length>0&&(console.log(a),h(a.map(e=>e.message).join(" "))),f(e.error.messages.filter(e=>"validation"===e.type)),{type:t.responseTypes.ERROR}}return{type:t.responseTypes.SUCCESS,meta:{paymentMethodData:{payu_sf_token:e.body.token,payuBrowser_screenWidth:window.screen.width.toString(),payuBrowser_javaEnabled:window.navigator.javaEnabled(),payuBrowser_timezoneOffset:(new Date).getTimezoneOffset().toString(),payuBrowser_screenHeight:window.screen.height.toString(),payuBrowser_userAgent:window.navigator.userAgent,payuBrowser_colorDepth:window.screen.colorDepth.toString(),payuBrowser_language:window.navigator.language}}}})}catch(e){console.error(e),h(e.message)}return{type:t.responseTypes.ERROR}})),[r,t.responseTypes.ERROR,t.responseTypes.SUCCESS]),(0,n.jsxs)(n.Fragment,{children:[!i&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{id:`payu_description_${u}`,children:g}),(0,n.jsxs)("div",{className:"block-payu-card",children:[(0,n.jsxs)("div",{className:"block-payu-card-number",children:[(0,n.jsx)("label",{htmlFor:"payu-card-number",children:(0,s.__)("Card number","woo-payu-payment-gateway")}),E&&(0,n.jsx)(c,{setElementFocus:k,secureForms:E,formOptions:{...l},errors:w.filter(e=>"number"===e.source)})]}),(0,n.jsxs)("div",{className:"block-payu-card-date",children:[(0,n.jsx)("label",{htmlFor:"payu-card-date",children:(0,s.__)("Expire date","woo-payu-payment-gateway")}),E&&(0,n.jsx)(d,{setElementFocus:k,focus:"expire"===j,secureForms:E,formOptions:{...l,placeholder:{...l.placeholder,date:(0,s.__)("MM/YY","woo-payu-payment-gateway")}},errors:w.filter(e=>"date"===e.source)})]}),(0,n.jsxs)("div",{className:"block-payu-card-cvv",children:[(0,n.jsx)("label",{htmlFor:"payu-card-cvv",children:(0,s.__)("CVV","woo-payu-payment-gateway")}),E&&(0,n.jsx)(p,{secureForms:E,focus:"cvv"===j,formOptions:{...l},errors:w.filter(e=>"cvv"===e.source)})]})]}),(0,n.jsx)(S,{})]}),i&&(0,n.jsx)(a.StoreNotice,{status:"error",isDismissible:!1,children:i}),m&&(0,n.jsx)(a.StoreNotice,{status:"error",isDismissible:!1,children:m})]})},P=e=>{const{PaymentMethodLabel:t}=e.components;return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(t,{text:w,className:"payu-block-method"}),(0,n.jsx)("span",{className:"payu-block-method-logo",children:(0,n.jsx)("img",{src:f,alt:"Mastercard / Visa",name:w})})]})},F={name:u,label:(0,n.jsx)(P,{}),content:(0,n.jsx)(k,{}),edit:(0,n.jsx)(k,{}),canMakePayment:()=>h,ariaLabel:w};(0,r.registerPaymentMethod)(F)})();